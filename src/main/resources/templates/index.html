<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script th:src="@{/js/auth.js}"></script>
</head>
<body>
    <a href="/posts">게시판</a>

    <p>로그인 없이도 이 페이지는 누구나 볼 수 있어요!</p>

    <div id="auth-buttons"></div>

    <h1>실시간 차트</h1>

    <table border="1">
        <thead>
        <tr>
            <th>순위</th>
            <th>제목</th>
            <th>아티스트</th>
            <th>앨범</th>
            <th>커버</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="music, stat : ${chart}">
            <td th:text="${stat.index + 1}"></td>
            <td th:text="${music.title}"></td>
            <td th:text="${music.artist}"></td>
            <td th:text="${music.album}"></td>
            <td><img th:src="${music.coverImageUrl}" width="50"/></td>
        </tr>
        </tbody>
    </table>

    <script>
        function logout() {
            localStorage.removeItem("accessToken");
            window.location.href = "/login";
        }

        function showAuthButtons() {
            const token = localStorage.getItem("accessToken");
            const authDiv = document.getElementById("auth-buttons");

            if (token) {
                // ✅ 로그인 상태 → 로그아웃 버튼
                authDiv.innerHTML = `
          <a href="/me.html">내 정보</a>
          <button onclick="logout()">로그아웃</button>
        `;
            } else {
                // ✅ 비로그인 상태 → 로그인/회원가입 버튼
                authDiv.innerHTML = `
          <a href="/login">로그인</a> |
          <a href="/signup">회원가입</a>
        `;
            }
        }

        showAuthButtons();
    </script>
</body>
</html>